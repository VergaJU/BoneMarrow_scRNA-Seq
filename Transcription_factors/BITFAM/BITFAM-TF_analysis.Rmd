---
title: "BITFAM-TF_analysis"
author: "Jacopo Umberto Verga"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# BITFAM TF activity

## NK cells in MM

Load data and prepare environment:

```{r}
library(Seurat)
library(BITFAM)
```

```{r}
dat <- readRDS("Data/mm_nk.Rds")
dat <- SetIdent(dat,value="new_label")
dat
```
Normalize with BITFAM and run it 

```{r}
data_matrix_normalized <- BITFAM_preprocess(raw_data = dat[["RNA"]]@counts
```

```{r}
head(rownames(data_matrix_normalized), n = 5)
```

```{r}
BITFAM_res <- BITFAM(data = data_matrix_normalized, species = "human", scATAC_obj = NA, ncores = parallel::detectCores())
```

